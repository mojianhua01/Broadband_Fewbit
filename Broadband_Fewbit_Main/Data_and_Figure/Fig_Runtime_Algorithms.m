% clc;
close all;
% time = [
% 0.1857	0.2248	0.2648	0.3073	0.3464	0.3831	0.4281	0.4614
% 0.3049	0.3703	0.4472	0.53	0.5872	0.6562	0.7207	0.7977
% 0.2968	0.3904	0.4803	0.5321	0.5867	0.6223	0.7122	0.7905
% % 0.3079	0.3982	0.4539	0.539	0.619	0.6763	0.8064	0.8661 %QIHT, fast, 10^(-2)
% 0.6358	0.8609	0.9121	1.0075	1.1316	1.2814	1.4202	1.5314 %QIHT,fast, 10^(-2.5)
% 0.3307	0.4422	0.4976	0.5816	0.6611	0.7141	0.8491	0.9012 %QIST,fast
% 0.4354	0.55	0.6551	0.6878	0.7945	0.8689	0.9935	1.0934 % BG, fast
% 0.824	0.97	1.0927	1.1163	1.2397	1.3445	1.5287	1.6059 % GM, fast
% 0.8283	0.998	1.1987	1.3855	1.5948	1.6819	1.8635	2.0509 % SPGL1
% % 1.1735	1.645	1.6476	1.8862	2.1085	2.3757	2.6668	2.7926 % QIHT
% % 10^(-2)
% 1.54681	2.13017	2.27267	2.61191	3.1137	3.3018	3.53627	4.02389 %QIHT 10^(-2.5)
% 1.065	1.3806	1.577	1.7397	2.0655	2.234	2.3944	2.667 %QIST
% 0.78935	1.15000	1.41074	1.7314	1.75985	1.86543	2.18891	2.41073 % BG
% 1.4198	1.75823	1.99665	2.07695	2.39665	2.65105	2.85125	3.1251  % GM
% ]';
% 
% Np = 512*(3:1:10);
% figure,
% plot1 = plot(Np, time, 'Linewidth',1);
% set(plot1(1),'Marker','d','LineStyle','-');
% set(plot1(2),'Marker','x','LineStyle','-');
% set(plot1(3),'Marker','V','LineStyle','-', 'color','[0.929 0.694 0.125]');
% set(plot1(4),'Marker','<','LineStyle','-','color','[0.494 0.184 0.556]');
% set(plot1(5),'Marker','^','LineStyle','-','color','[0.466 0.674 0.188]');
% set(plot1(6),'Marker','o','LineStyle','-','color','[0.301 0.745 0.933]');
% set(plot1(7),'Marker','s','LineStyle','-','color','[0.635 0.078 0.184]');
% set(plot1(8),'Marker','V','LineStyle','--', 'color','[0.929 0.694 0.125]');
% set(plot1(9),'Marker','<','LineStyle','--','color','[0.494 0.184 0.556]');
% set(plot1(10),'Marker','^','LineStyle','--','color','[0.466 0.674 0.188]');
% set(plot1(11),'Marker','o','LineStyle','--','color','[0.301 0.745 0.933]');
% set(plot1(12),'Marker','s','LineStyle','--','color','[0.635 0.078 0.184]');
% 
% 
% 
% 
% grid on;
% set(gca, 'XTick', Np)
% xlabel('Training Length', 'fontsize',14)
% ylabel('Runtime (s)', 'fontsize',14)
% legend('LS','ALMMSE','SPGL1, fast','QIHT, fast','QIST, fast','EM-BG-AMP, fast','EM-GM-AMP, fast',...
%     'SPGL1','QIHT','QIST','EM-BG-AMP','EM-GM-AMP');

time = [
0.1864	0.2302	0.2692	0.3063	0.3447	0.3859	0.4438	0.482
0.3016	0.3862	0.4426	0.5486	0.5767	0.6976	0.746	0.7947
0.3535	0.4662	0.5378	0.5711	0.6788	0.7577	0.8663	0.9082
0.6358	0.8609	0.9121	1.0075	1.1316	1.2814	1.4202	1.5314
0.5127	0.8499	0.9527	1.0059	1.2261	1.3482	1.4993	1.6297
1.0794	1.2636	1.5162	1.5799	1.7572	1.9468	2.1334	2.3224
0.74584	0.80496	0.88888	1.17608	1.30112	1.4016	1.51912	1.616
0.725	0.9504	1.1804	1.3795	1.6244	1.801	1.9257	2.117
1.54681	2.03017	2.27267	2.61191	3.1137	3.3018	3.53627	4.02389
0.78935	1.1853	1.41074	1.7314	1.75985	1.86543	2.18891	2.41073
1.16808	1.5049	1.841705	2.171655	2.436775	2.583615	2.86259	3.21731
1.197	1.440846154	1.627230769	1.998923077	2.213153846	2.423538462	2.618846154	2.846
]';

Np = 512*(3:1:10);
figure,
plot1 = plot(Np, time, 'Linewidth',1);
set(plot1(1),'Marker','d','LineStyle','-');
set(plot1(2),'Marker','x','LineStyle','-');
set(plot1(3),'Marker','V','LineStyle','-', 'color','[0.929 0.694 0.125]');
set(plot1(4),'Marker','<','LineStyle','-','color','[0.494 0.184 0.556]');
set(plot1(5),'Marker','o','LineStyle','-','color','[0.301 0.745 0.933]');
set(plot1(6),'Marker','s','LineStyle','-','color','[0.635 0.078 0.184]');
set(plot1(7),'Marker','^','LineStyle','-','color','[0.466 0.674 0.188]');
set(plot1(8),'Marker','V','LineStyle','--', 'color','[0.929 0.694 0.125]');
set(plot1(9),'Marker','<','LineStyle','--','color','[0.494 0.184 0.556]');
set(plot1(10),'Marker','o','LineStyle','--','color','[0.301 0.745 0.933]');
set(plot1(11),'Marker','s','LineStyle','--','color','[0.635 0.078 0.184]');
set(plot1(12),'Marker','^','LineStyle','--','color','[0.466 0.674 0.188]');

grid on;
set(gca, 'XTick', Np)
xlabel('Training Length', 'fontsize',14)
ylabel('Runtime (s)', 'fontsize',14)
legend('LS','ALMMSE','SPGL1, fast','QIHT, fast','EM-BG-GAMP, fast',...
'EM-GM-GAMP, fast','EM-GM-VAMP, fast',...
    'SPGL1','QIHT','EM-BG-GAMP','EM-GM-GAMP','EM-GM-VAMP');


%% runtime of GAMP and VAMP algorithms to achieve NMSE_BPDN_dB vs training length
time = [0.196896693	0.264974607	0.355241774	0.390734676	0.438720251	0.512862029	0.529855541	0.603499338	0.682180533
0.172539355	0.220130574	0.319687518	0.440179651	0.644142906	0.863916129	0.95873222	1.103173758	1.186410135
0.27351377	0.301511281	0.377206644	0.426459554	0.485375905	0.641323046	0.701280091	0.7777747	0.822475641
0.12926688	0.156133119	0.185266124	0.226512375	0.360649604	0.394231706	0.330169887	0.480367475	0.503993181
0.398081368	0.622251736	0.819358073	0.941375098	1.082636602	1.220117459	1.520692987	1.467596657	1.698949781
0.272412611	0.333692703	0.461828893	0.700729546	0.907933933	1.347816765	1.545489961	1.682968082	1.866535015
0.33277417	0.448890052	0.501529065	0.578457666	0.664449848	0.918567994	1.020924689	1.118722918	1.405607026
0.171430467	0.20677761	0.259889262	0.295052479	0.596460426	0.600574827	0.708006282	0.674839638	0.726439359
];

Np = 512*(2:1:10);
figure,
plot1 = plot(Np, time, 'Linewidth',1);
set(plot1(1),'Marker','V','LineStyle','-', 'color','[0.929 0.694 0.125]');
set(plot1(2),'Marker','o','LineStyle','-','color','[0.301 0.745 0.933]');
set(plot1(3),'Marker','s','LineStyle','-','color','[0.635 0.078 0.184]');
set(plot1(4),'Marker','^','LineStyle','-','color','[0.466 0.674 0.188]');
set(plot1(5),'Marker','V','LineStyle','--', 'color','[0.929 0.694 0.125]');
set(plot1(6),'Marker','o','LineStyle','--','color','[0.301 0.745 0.933]');
set(plot1(7),'Marker','s','LineStyle','--','color','[0.635 0.078 0.184]');
set(plot1(8),'Marker','^','LineStyle','--','color','[0.466 0.674 0.188]');

grid on;
set(gca, 'XTick', Np)
xlabel('Training Length', 'fontsize',14)
ylabel('Runtime (s)', 'fontsize',14)
legend('SPGL1, fast','EM-BG-GAMP, fast',...
'EM-GM-GAMP, fast','EM-GM-VAMP, fast',...
    'SPGL1','EM-BG-GAMP','EM-GM-GAMP','EM-GM-VAMP');

%% 10 dB
NMSE_QIST = [1.00000000000000,0.825946070207793,0.689412154281508,0.575861564915109,0.481968082712260,0.405091149999238,0.342098563428121,0.290386778696217,0.247994733414900,0.213205233555999,0.184624634195950,0.161131169128010,0.141757878062132,0.125718410081602,0.112397799044591,0.101295512696158,0.0919974670323841,0.0841996571043280,0.0776304232987895,0.0720486429558201,0.0673016915455514,0.0632551596444110,0.0597890336496396,0.0568081143274220,0.0542270245318256,0.0519828726809484,0.0500251005138125,0.0483103422191505,0.0468074426766002,0.0454880395718004,0.0443214315494865,0.0432875709966656,0.0423674204759492,0.0415457028932553,0.0408134873313906,0.0401611651072198,0.0395725913804847,0.0390401434699092,0.0385604876971462,0.0381272298221275,0.0377339856697402,0.0373762872715912,0.0370517963931530,0.0367566707156414,0.0364867310287190,0.0362395237482699,0.0360142406197074,0.0358078047900963,0.0356188704259231,0.0354445375405656,0.0352835106977649
    ];
% NMSE_QIHT = [1	0.831396893	0.700051483	0.589723006	0.49872994	0.423996308	0.362741783	0.312520955	0.27137674	0.237603994	0.20986639	0.187031911	0.16818123	0.152560773	0.139568105	0.128711139	0.119588987	0.111908354	0.105411438	0.099884518	0.095164487	0.091125389	0.087648568	0.084640972	0.082029864	0.079752233	0.07775905	0.076006823	0.074462484	0.073098003	0.071885732	0.070807585	0.069846654	0.068986423	0.068215752	0.067523383	0.066898523	0.066332911	0.065821117	0.065357074
% ];
NMSE_QIHT = [1.00000000000000,0.820557000054515,0.686235814995455,0.571080659287732,0.476447513955901,0.398306500111663,0.334677459928616,0.282725009686205,0.240384905797174,0.205890460161773,0.177713572748889,0.154742078536847,0.136021399466788,0.120730156766180,0.108292694024545,0.0981138728435955,0.0898141150233410,0.0830056062665353,0.0774126246983092,0.0728400422769732,0.0690760911863050,0.0659701632565045,0.0633960893056361,0.0612729209405991,0.0595102152697965,0.0580486792890390,0.0568221991856352,0.0557994211491409,0.0549392413655144,0.0542162657224936,0.0536058603179572,0.0530858380027449,0.0526433077250266,0.0522668445748511,0.0519447059443835,0.0516692537703933,0.0514333907476208,0.0512312718060576,0.0510550252692227,0.0508995646405050,0.0507653296872573,0.0506481261654891,0.0505471231513059,0.0504581215844059,0.0503801812012006,0.0503117901080699,0.0502505029359053,0.0501974239735188,0.0501521466792711,0.0501103463375359
    ];
NMSE_BG = [1.00000000000000,0.341507754082822,0.0683321740199945,0.0345283117681503,0.0236209499617141,0.0183626598495156,0.0158352685999850,0.0147215006955147,0.0141783092401394,0.0139012917317005,0.0137589173832761,0.0136841634008719,0.0136424179736416,0.0136173781153316,0.0136010928464507,0.0135896019071280,0.0135809126667608,0.0135740116209443,0.0135683679681424,0.0135636851501841,0.0135597790234174,0.0135565200646753,0.0135538070791549,0.0135515557448723,0.0135496937526114
    ];
NMSE_GM = [1.00000000000000,0.338156907079746,0.0653570138453298,0.0311954577406422,0.0208872000873524,0.0159531013557544,0.0135617661822248,0.0123917783812346,0.0117612444064740,0.0114061304259840,0.0111940968300229,0.0110581666213480,0.0109671213446629,0.0109049396951774,0.0108616068826414,0.0108308790620557,0.0108088660670828,0.0107930032546888,0.0107815232177517,0.0107731879211748,0.0107671295039768,0.0107627414302309,0.0107595999032150,0.0107574072468302,0.0107559520121949
    ];
figure,
plot(10*log10(NMSE_QIHT),'-<','Linewidth',1,'color','[0.494 0.184 0.556]');
hold on;
plot(10*log10(NMSE_QIST),'-^','Linewidth',1,'color','[0.466 0.674 0.188]');
plot(10*log10(NMSE_BG),'-o','Linewidth',1,'color','[0.301 0.745 0.933]');
plot(10*log10(NMSE_GM),'-s','Linewidth',1,'color','[0.635 0.078 0.184]');
grid on;
xlabel('Iterations', 'fontsize',14)
ylabel('Normalized MSE($\widehat{\mathbf{x}}^{(n)}$) (dB)', 'fontsize',14, 'interpreter','latex')
legend('QIHT','QIST','EM-BG-AMP','EM-GM-AMP')

%% 0 dB
NMSE_QIHT_dB = [0 -0.858900000000000,-1.63530000000000,-2.43300000000000,-3.21980000000000,-3.99780000000000,-4.75370000000000,-5.48640000000000,-6.19090000000000,-6.86360000000000,-7.50280000000000,-8.10390000000000,-8.66390000000000,-9.18180000000000,-9.65400000000000,-10.0827000000000,-10.4666000000000,-10.8089000000000,-11.1119000000000,-11.3763000000000,-11.6067000000000,-11.8065000000000,-11.9794000000000,-12.1273000000000,-12.2541000000000,-12.3621000000000,-12.4548000000000,-12.5337000000000,-12.6012000000000,-12.6587000000000,-12.7079000000000,-12.7502000000000,-12.7866000000000,-12.8177000000000,-12.8446000000000,-12.8677000000000,-12.8875000000000,-12.9046000000000,-12.9196000000000,-12.9329000000000,-12.9443000000000,-12.9544000000000,-12.9630000000000,-12.9707000000000,-12.9774000000000,-12.9833000000000,-12.9886000000000,-12.9932000000000,-12.9971000000000,-13.0007000000000];
NMSE_BG_GAMP_dB = [1.63935669314058e-14,-4.54675327459935,-9.77416595842241,-12.1291526780969,-12.8542473941659,-13.1281505954172,-13.2391218549839,-13.2832702375137,-13.3005498662172,-13.3071253647503,-13.3094756126429,-13.3101966612240,-13.3103261189573,-13.3102705647303,-13.3101802157815,-13.3101030275782,-13.3100485035548,-13.3100136158903,-13.3099927163329,-13.3099808302282,-13.3099743821514,-13.3099710522681,-13.3099694316471,-13.3099687064244,-13.3099684264168,-13.3099683529348,-13.3099683652137,-13.3099684056624,-13.3099684491171,-13.3099684862208,-13.3099685147878,-13.3099685355187,-13.3099685499992,-13.3099685598491,-13.3099685664213,-13.3099685707433,-13.3099685735542,-13.3099685753665,-13.3099685765270,-13.3099685772661,-13.3099685777348,-13.3099685780308,-13.3099685782174,-13.3099685783346,-13.3099685784082,-13.3099685784542,-13.3099685784830,-13.3099685785011,-13.3099685785123,-13.3099685785193];
NMSE_GM_GAMP_dB = [1.63935669314058e-14,-4.61851988587679,-9.97666346692833,-12.4143319890470,-13.2233695375195,-13.5444356904821,-13.6796874851875,-13.7414982594334,-13.7745452829279,-13.7962397167244,-13.8130870504862,-13.8274542739572,-13.8401923196484,-13.8515997740165,-13.8617756716485,-13.8707551339614,-13.8785655703268,-13.8852512823508,-13.8908831671533,-13.8955590864115,-13.8993974978571,-13.9025270411959,-13.9050752123264,-13.9071589590099,-13.9088788514870,-13.9103169901428,-13.9115377511245,-13.9125901364922,-13.9135106899817,-13.9143263215604,-13.9150567268591,-13.9157163140347,-13.9163156694834,-13.9168626405281,-13.9173631205449,-13.9178216119529,-13.9182416272637,-13.9186259736696,-13.9189769544715,-13.9192965113254,-13.9195863244370,-13.9198478829057,-13.9200825339116,-13.9202915169437,-13.9204759874908,-13.9206370333519,-13.9207756858103,-13.9208929272679,-13.9209896964689,-13.9210668921010];
NMSE_BG_VAMP_dB = [0, -11.7597749700000,-13.2846980100000,-13.3225014200000,-13.3058750900000,-13.3010591300000,-13.3018210400000,-13.3029759500000,-13.3038474700000,-13.3043883300000,-13.3047140900000,-13.3049041200000,-13.3050142700000,-13.3050775100000,-13.3051137800000,-13.3051345500000,-13.3051464500000,-13.3051532800000,-13.3051572100000,-13.3051594700000,-13.3051607800000,-13.3051615400000,-13.3051619800000,-13.3051622300000,-13.3051623800000,-13.3051624700000,-13.3051625200000,-13.3051625500000,-13.3051625700000,-13.3051625800000,-13.3051625800000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000,-13.3051625900000];
NMSE_GM_VAMP_dB = [0, -13.5315000000000,-13.5657000000000,-13.7415000000000,-13.7701000000000,-13.7937000000000,-13.8068000000000,-13.8184000000000,-13.8288000000000,-13.8385000000000,-13.8474000000000,-13.8556000000000,-13.8629000000000,-13.8694000000000,-13.8749000000000,-13.8797000000000,-13.8837000000000,-13.8870000000000,-13.8898000000000,-13.8921000000000,-13.8940000000000,-13.8957000000000,-13.8971000000000,-13.8984000000000,-13.8995000000000,-13.9005000000000,-13.9014000000000,-13.9022000000000,-13.9030000000000,-13.9037000000000,-13.9043000000000,-13.9049000000000,-13.9055000000000,-13.9061000000000,-13.9066000000000,-13.9071000000000,-13.9076000000000,-13.9081000000000,-13.9085000000000,-13.9090000000000,-13.9094000000000,-13.9098000000000,-13.9102000000000,-13.9106000000000,-13.9109000000000,-13.9113000000000,-13.9116000000000,-13.9119000000000,-13.9123000000000,-13.9126000000000];
figure,
plot(NMSE_QIHT_dB,'-<','Linewidth',1,'color','[0.494 0.184 0.556]');
hold on;
plot(NMSE_BG_GAMP_dB,'-o','Linewidth',1,'color','[0.301 0.745 0.933]');
plot(NMSE_GM_GAMP_dB,'-s','Linewidth',1,'color','[0.635 0.078 0.184]');
plot(NMSE_BG_VAMP_dB,'-^','Linewidth',1,'color','[0.466 0.674 0.188]');
plot(NMSE_GM_VAMP_dB,'-+','Linewidth',1,'color','[0, 0.447, 0.741]');
grid on;
xlabel('Iterations', 'fontsize',14)
ylabel('Normalized MSE($\widehat{\mathbf{x}}^{(k)}$) (dB)', 'fontsize',14, 'interpreter','latex')
legend('QIHT','EM-BG-GAMP','EM-GM-GAMP','EM-BG-VAMP','EM-GM-VAMP')
xlim([0, 35])
ylim([-15, 2])


%% 10 dB
LS.time = 0.2316;
LS.NMSE = -10.4971;
ALMMSE.time = .37;
ALMMSE.NMSE = -10.4971;
SPGL1.time = 0.4864;
SPGL1.NMSE = -15.7078;
QIHT.time = [0.126700000000000,0.152000000000000,0.162800000000000,0.189900000000000,0.215500000000000,0.235500000000000,0.510600000000000,0.750500000000000,1.00880000000000,1.26510000000000,1.49790000000000];
QIHT.NMSE = [-3.92450000000000,-4.65850000000000,-5.37020000000000,-6.05560000000000,-6.71200000000000,-7.33710000000000,-11.7197000000000,-13.5339000000000,-14.2327000000000,-14.5243000000000,-14.6583000000000];
BG.time = [0.181300000000000,0.272400000000000,0.377600000000000,0.487400000000000,0.588300000000000,0.675400000000000,0.779400000000000,0.877100000000000,0.963500000000000,1.05830000000000,1.16090000000000,1.25800000000000,1.35340000000000,1.44180000000000,1.53110000000000];
BG.NMSE = [-4.66599431000000,-11.6537476200000,-14.6182465600000,-16.2670264000000,-17.3606441100000,-18.0037456600000,-18.3204791600000,-18.4837555600000,-18.5694484200000,-18.6141573700000,-18.6378174900000,-18.6510864900000,-18.6590650300000,-18.6642619500000,-18.6679326500000];
GM.time = [0.276900000000000,0.407400000000000,0.563700000000000,0.675200000000000,0.816100000000000,0.966100000000000,1.07880000000000,1.19920000000000,1.34420000000000,1.47120000000000,1.60530000000000,1.77400000000000];
GM.NMSE = [-4.70881737400000,-11.8470779900000,-15.0590863700000,-16.8011977300000,-17.9715487600000,-18.6768374800000,-19.0686636200000,-19.2954672500000,-19.4286166700000,-19.5101094100000,-19.5631687100000,-19.5990735100000];

figure,
plot(LS.time, LS.NMSE,'linewidth',1,'Marker','d','color','[0 0.447 0.741]');
hold on;
grid on;
plot(ALMMSE.time,ALMMSE.NMSE,'linewidth', 1,'Marker','x','color','[0.85 0.325 0.098]');
plot(SPGL1.time, SPGL1.NMSE, 'linewidth', 1,'Marker','v','color','[0.929 0.694 0.125]');
plot(QIHT.time, QIHT.NMSE,'-<','Linewidth',1,'color','[0.494 0.184 0.556]');
hold on;
plot(BG.time, BG.NMSE,'-o','Linewidth',1,'color','[0.301 0.745 0.933]');
plot(GM.time, GM.NMSE,'-s','Linewidth',1,'color','[0.635 0.078 0.184]');
grid on;
xlabel('Runtime (s)', 'fontsize',14)
ylabel('Normalized MSE($\widehat{\mathbf{x}}^{(k)}$) (dB)', 'fontsize',14, 'interpreter','latex')
legend('LS','ALMMSE','SPGL1','QIHT','EM-BG-AMP','EM-GM-AMP')

%% 0 dB
LS.time = 0.23335;
LS.NMSE = -2.5264;
ALMMSE.time = 0.3762;
ALMMSE.NMSE = -4.2186;
SPGL1.time = 0.4073;
SPGL1.NMSE = -12.5403;
QIHT.time = [0.023
0.046
0.069
0.092
0.115
0.138
0.161
0.1841
0.2071
0.2301
0.2531
0.2761
0.2991
0.3221
0.3451
0.3681
0.3911
0.4141
0.4371
0.4601
0.4831
0.5061
0.5292
0.5522
0.5752
0.5982
0.6212
0.6442
0.6672
0.6902
0.7132
0.7362
0.7592
0.7822
0.8052
0.8282
0.8512
0.8743
0.8973
0.9203
0.9433
0.9663
0.9893
1.0123
1.0353
1.0583
1.0813
1.1043
1.1273
1.1503
];
QIHT.NMSE = [-0.8589
-1.6353
-2.433
-3.2198
-3.9978
-4.7537
-5.4864
-6.1909
-6.8636
-7.5028
-8.1039
-8.6639
-9.1818
-9.654
-10.0827
-10.4666
-10.8089
-11.1119
-11.3763
-11.6067
-11.8065
-11.9794
-12.1273
-12.2541
-12.3621
-12.4548
-12.5337
-12.6012
-12.6587
-12.7079
-12.7502
-12.7866
-12.8177
-12.8446
-12.8677
-12.8875
-12.9046
-12.9196
-12.9329
-12.9443
-12.9544
-12.963
-12.9707
-12.9774
-12.9833
-12.9886
-12.9932
-12.9971
-13.0007
-13.0039
];
BG_GAMP.time = [0.1826
0.2717
0.3576
0.447
0.5364
0.6258
0.7152
0.8046
0.894
0.9834
1.0728
1.1622
1.2516
1.341
1.4304
];
BG_GAMP.NMSE = [-4.5468
-9.7742
-12.1292
-12.8542
-13.1282
-13.2391
-13.2833
-13.3005
-13.3071
-13.3095
-13.3102
-13.3103
-13.3103
-13.3102
-13.3101];

GM_GAMP.time = [0.2473
0.371
0.4946
0.6183
0.742
0.8656
0.9893
1.113
1.2366
1.3603
1.4839
1.6076];

GM_GAMP.NMSE = [-4.6185
-9.9767
-12.4143
-13.2234
-13.5444
-13.6797
-13.7415
-13.7745
-13.7962
-13.8131
-13.8275
-13.8402];

BG_VAMP.time = [0.169712611
0.246430489
0.346047112
0.408203466
0.496962549
0.55738177
0.643315986
0.708887184
0.786202289
0.834493337
0.941916745
1.010920143
1.057340081];

BG_VAMP.NMSE = [-11.75977497
-13.28469801
-13.32250142
-13.30587509
-13.30105913
-13.30182104
-13.30297595
-13.30384747
-13.30438833
-13.30471409
-13.30490412
-13.30501427
-13.30507751];

GM_VAMP.time = [0.22512
0.33072
0.4356
0.55592
0.66096
0.7708
0.87832
1.0088
1.09112
1.20256
1.31496
1.41368];

GM_VAMP.NMSE = [-11.62307
-12.98444091
-13.64367626
-13.78450597
-13.81983018
-13.83439151
-13.84245438
-13.84896913
-13.85507811
-13.8610883
-13.86694356
-13.8725271];

figure,
plot(LS.time, LS.NMSE,'linewidth',1,'Marker','d','color','[0 0.447 0.741]');
hold on;
grid on;
plot(ALMMSE.time,ALMMSE.NMSE,'linewidth', 1,'Marker','x','color','[0.85 0.325 0.098]');
plot(SPGL1.time, SPGL1.NMSE, 'linewidth', 1,'Marker','v','color','[0.929 0.694 0.125]');
plot(QIHT.time, QIHT.NMSE,'-<','Linewidth',1,'color','[0.494 0.184 0.556]');
plot(BG_GAMP.time, BG_GAMP.NMSE,'-o','Linewidth',1,'color','[0.301 0.745 0.933]');
plot(GM_GAMP.time, GM_GAMP.NMSE,'-s','Linewidth',1,'color','[0.635 0.078 0.184]');
plot(BG_VAMP.time, BG_VAMP.NMSE,'-^','Linewidth',1,'color','[0.466 0.674 0.188]');
plot(GM_VAMP.time,GM_VAMP.NMSE,'-+','Linewidth',1,'color','[0, 0.447, 0.741]');

xlabel('Runtime (s)', 'fontsize',14)
ylabel('Normalized MSE($\widehat{\mathbf{x}}^{(k)}$) (dB)', 'fontsize',14, 'interpreter','latex')
legend('LS','ALMMSE','SPGL1','QIHT','EM-BG-GAMP','EM-GM-GAMP','EM-BG-VAMP','EM-GM-VAMP')
